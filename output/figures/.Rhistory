abline(h=lowCI,lty=2)
abline(h=highCI,lty=2)
#abline(v=116443467, col="blue",lwd=2,lty=3)
dev.off()
Chr_pos <- rollapply(Chr06_sort$start, 40, mean, na.rm = TRUE)
Chr_ratio <- rollapply(Chr06_sort$ratio, 40, mean, na.rm = TRUE)
plot(Chr06_sort$start, Chr06_sort$ratio,col=alpha(RMpalette[3], 0.5),pch=20, ylim=c(-10,10), xlab="Position(bp)", ylab="Log2(male:female)",main="Chr06")
lines(Chr_pos, Chr_ratio,type="l",lwd=5, col=RMpalette[5])
abline(h=lowCI,lty=2)
abline(h=highCI,lty=2)
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/chr6_expratio_gonad.pdf", width=7,height=5)
Chr_pos <- rollapply(Chr06_sort$start, 40, mean, na.rm = TRUE)
Chr_ratio <- rollapply(Chr06_sort$ratio, 40, mean, na.rm = TRUE)
plot(Chr06_sort$start, Chr06_sort$ratio,col=alpha(RMpalette[3], 0.5),pch=20, ylim=c(-10,10), xlab="Position(bp)", ylab="Log2(male:female)",main="Chr06")
lines(Chr_pos, Chr_ratio,type="l",lwd=5, col=RMpalette[5])
abline(h=lowCI,lty=2)
abline(h=highCI,lty=2)
#abline(v=116443467, col="blue",lwd=2,lty=3)
dev.off()
Chr_pos <- rollapply(Chr07_sort$start, 40, mean, na.rm = TRUE)
Chr_ratio <- rollapply(Chr07_sort$ratio, 40, mean, na.rm = TRUE)
plot(Chr07_sort$start, Chr07_sort$ratio,col=alpha(RMpalette[3], 0.5),pch=20, ylim=c(-10,10), xlab="Position(bp)", ylab="Log2(male:female)",main="Chr07")
lines(Chr_pos, Chr_ratio,type="l",lwd=5, col=RMpalette[5])
abline(h=lowCI,lty=2)
abline(h=highCI,lty=2)
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/chr7_expratio_gonad.pdf", width=7,height=5)
Chr_pos <- rollapply(Chr07_sort$start, 40, mean, na.rm = TRUE)
Chr_ratio <- rollapply(Chr07_sort$ratio, 40, mean, na.rm = TRUE)
plot(Chr07_sort$start, Chr07_sort$ratio,col=alpha(RMpalette[3], 0.5),pch=20, ylim=c(-10,10), xlab="Position(bp)", ylab="Log2(male:female)",main="Chr07")
lines(Chr_pos, Chr_ratio,type="l",lwd=5, col=RMpalette[5])
abline(h=lowCI,lty=2)
abline(h=highCI,lty=2)
#abline(v=116443467, col="blue",lwd=2,lty=3)
dev.off()
Chr_pos <- rollapply(Chr08_sort$start, 40, mean, na.rm = TRUE)
Chr_ratio <- rollapply(Chr08_sort$ratio, 40, mean, na.rm = TRUE)
plot(Chr08_sort$start, Chr08_sort$ratio,col=alpha(RMpalette[3], 0.5),pch=20, ylim=c(-10,10), xlab="Position(bp)", ylab="Log2(male:female)",main="Chr08")
lines(Chr_pos, Chr_ratio,type="l",lwd=5, col=RMpalette[5])
abline(h=lowCI,lty=2)
abline(h=highCI,lty=2)
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/chr8_expratio_gonad.pdf", width=7,height=5)
Chr_pos <- rollapply(Chr08_sort$start, 40, mean, na.rm = TRUE)
Chr_ratio <- rollapply(Chr08_sort$ratio, 40, mean, na.rm = TRUE)
plot(Chr08_sort$start, Chr08_sort$ratio,col=alpha(RMpalette[3], 0.5),pch=20, ylim=c(-10,10), xlab="Position(bp)", ylab="Log2(male:female)",main="Chr08")
lines(Chr_pos, Chr_ratio,type="l",lwd=5, col=RMpalette[5])
abline(h=lowCI,lty=2)
abline(h=highCI,lty=2)
#abline(v=116443467, col="blue",lwd=2,lty=3)
dev.off()
Chr_pos <- rollapply(Chr09_sort$start, 40, mean, na.rm = TRUE)
Chr_ratio <- rollapply(Chr09_sort$ratio, 40, mean, na.rm = TRUE)
plot(Chr09_sort$start, Chr09_sort$ratio,col=alpha(RMpalette[3], 0.5),pch=20, ylim=c(-10,10), xlab="Position(bp)", ylab="Log2(male:female)",main="Chr09")
lines(Chr_pos, Chr_ratio,type="l",lwd=5, col=RMpalette[5])
abline(h=lowCI,lty=2)
abline(h=highCI,lty=2)
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/chr9_expratio_gonad.pdf", width=7,height=5)
Chr_pos <- rollapply(Chr09_sort$start, 40, mean, na.rm = TRUE)
Chr_ratio <- rollapply(Chr09_sort$ratio, 40, mean, na.rm = TRUE)
plot(Chr09_sort$start, Chr09_sort$ratio,col=alpha(RMpalette[3], 0.5),pch=20, ylim=c(-10,10), xlab="Position(bp)", ylab="Log2(male:female)",main="Chr09")
lines(Chr_pos, Chr_ratio,type="l",lwd=5, col=RMpalette[5])
abline(h=lowCI,lty=2)
abline(h=highCI,lty=2)
#abline(v=116443467, col="blue",lwd=2,lty=3)
dev.off()
Chr_pos <- rollapply(Chr10_sort$start, 40, mean, na.rm = TRUE)
Chr_ratio <- rollapply(Chr10_sort$ratio, 40, mean, na.rm = TRUE)
plot(Chr10_sort$start, Chr10_sort$ratio,col=alpha(RMpalette[3], 0.5),pch=20, ylim=c(-10,10), xlab="Position(bp)", ylab="Log2(male:female)",main="Chr10")
lines(Chr_pos, Chr_ratio,type="l",lwd=5, col=RMpalette[5])
abline(h=lowCI,lty=2)
abline(h=highCI,lty=2)
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/chr10_expratio_gonad.pdf", width=7,height=5)
Chr_pos <- rollapply(Chr10_sort$start, 40, mean, na.rm = TRUE)
Chr_ratio <- rollapply(Chr10_sort$ratio, 40, mean, na.rm = TRUE)
plot(Chr10_sort$start, Chr10_sort$ratio,col=alpha(RMpalette[3], 0.5),pch=20, ylim=c(-10,10), xlab="Position(bp)", ylab="Log2(male:female)",main="Chr10")
lines(Chr_pos, Chr_ratio,type="l",lwd=5, col=RMpalette[5])
abline(h=lowCI,lty=2)
abline(h=highCI,lty=2)
#abline(v=116443467, col="blue",lwd=2,lty=3)
dev.off()
#intall R packages and loading libraries
library(ggplot2)
library(plyr)
install.packages("devtools")
library(devtools)
install_github("easyGgplot2", "kassambara")
library(easyGgplot2)
#set up the working directory
setwd("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/dnds")
#results directoy
setwd("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/")
##dnds for female-biased genes from XY females.
XY_fbias <- read.table("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/XY_unsb_dnds.txt", header = T)
##dnds for female-biased genes from XY females.
XY_sbun_dnds <- read.table("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/XY_unsb_dnds.txt", header = T)
##dnds for female-biased genes from XY females.
XY_sbun_dnds <- read.table("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/XY_unsb_dnds.txt", header = T)
str(XY_sbun_dnds)
ggplot(XY_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(XY_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
ylim(0,2) +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(XY_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
ylim(0,1.5) +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(XY_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
ylim(0,1) +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(XY_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(XY_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dn/ds') +
#scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(XY_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(XY_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
PDF("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/XY_sbun_dnds.pdf",width=8, height=8)
ggplot(XY_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
pdf("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/XY_sbun_dnds.pdf",width=8, height=8)
ggplot(XY_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
wilcox.test(XY_sbun_dnds$dnds[XY_sbun_dnds$bias=='unbias'], XY_sbun_dnds$dnds[XY_sbun_dnds$sb=='female'])
XY_sbun_dnds$dnds[XY_sbun_dnds$bias=='unbias']
wilcox.test(XY_sbun_dnds$dnds[XY_sbun_dnds$bias=='unbias'], XY_sbun_dnds$dnds[XY_sbun_dnds$bias=='female'])
### venns in R
install.packages("VennDiagram")
library("VennDiagram")
library(gridExtra)
library(grid)
library(ggplot2)
library(lattice)
#for the shared female-biased genes across five stages.
setwd <-'/Users/Wen-Juan/my_postdoc/useful_scripts/Tvedora_dev_RNAseq/'
datapath <- '/Users/Wen-Juan/my_postdoc/useful_scripts/Tvedora_dev_RNAseq/input/sex_bias/'
results <- '/Users/Wen-Juan/my_postdoc/useful_scripts/Tvedora_dev_RNAseq/input/sex_bias/'
#for shared female-biased genes
fivestages_fbias <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Tvedora_dev_RNAseq/input/sexbias_female.txt", header = TRUE)
str(fivestages_fbias)
fbis_g23 <- fivestages_fbias$trans[fivestages_fbias$stage=='G23']
fbis_g27 <- fivestages_fbias$trans[fivestages_fbias$stage=='G27']
fbis_g31 <- fivestages_fbias$trans[fivestages_fbias$stage=='G31']
fbis_g43 <- fivestages_fbias$trans[fivestages_fbias$stage=='G43']
fbis_g46 <- fivestages_fbias$trans[fivestages_fbias$stage=='G46']
g43XY_fbias <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Tvedora_dev_RNAseq/input/XY_fbias.txt", header = TRUE)
#overlap between G43 female biased genes and XY female biased genes.
venn.plot <- venn.diagram(list(G43=as.character(fbis_g43), G43XY=as.character(g43XY_fbias)), filename =NULL,
#fill=rainbow(5),
fill=c("orange","red"),
ext.line.lwd = 3,
cex = 2,
cat.cex = 2.5,
rotation.degree = 60)
grid.arrange(gTree(children=venn.plot),ncol = 1 )
#overlap between G43 female biased genes and XY female biased genes.
venn.plot <- venn.diagram(list(G43=as.character(fbis_g43), G43XY=as.character(g43XY_fbias)), filename =NULL,
#fill=rainbow(5),
fill=c("orange","red"),
ext.line.lwd = 3,
cex = 1,
cat.cex = 1.5)
#overlap between G43 female biased genes and XY female biased genes.
venn.plot <- venn.diagram(list(G43=as.character(fbis_g43), G43XY=as.character(g43XY_fbias)), filename =NULL,
#fill=rainbow(5),
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1.5)
grid.arrange(gTree(children=venn.plot),ncol = 1 )
venn_fbias_out <- arrangeGrob(gTree(children=venn.plot),ncol = 1 )
#for shared female-biased genes
fivestages_fbias <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Tvedora_dev_RNAseq/input/sexbias_female.txt", header = TRUE)
str(fivestages_fbias)
fbis_g23 <- fivestages_fbias$trans[fivestages_fbias$stage=='G23']
fbis_g27 <- fivestages_fbias$trans[fivestages_fbias$stage=='G27']
fbis_g31 <- fivestages_fbias$trans[fivestages_fbias$stage=='G31']
fbis_g43 <- fivestages_fbias$trans[fivestages_fbias$stage=='G43']
fbis_g46 <- fivestages_fbias$trans[fivestages_fbias$stage=='G46']
fbis_g43
fbis_g43 <- fivestages_fbias$trans[fivestages_fbias$stage=='G43']
fbis_g43
g43XY_fbias <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Tvedora_dev_RNAseq/input/XY_fbias.txt", header = TRUE)
g43XY_fbias
#overlap between G43 female biased genes and XY female biased genes.
venn.plot <- venn.diagram(list(G43=as.character(fbis_g43), G43XY=as.character(g43XY_fbias)), filename =NULL,
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1.5)
#overlap between G43 female biased genes and XY female biased genes.
venn.plot1 <- venn.diagram(list(G43=as.character(fbis_g43), G43XY=as.character(g43XY_fbias)), filename =NULL,
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1.5)
grid.arrange(gTree(children=venn.plot1),ncol = 1 )
venn_fbias_out <- arrangeGrob(gTree(children=venn.plot1),ncol = 1 )
grid.arrange(gTree(children=venn.plot1),ncol = 1 )
venn.plot1 <- venn.diagram(list(G43=as.character(fbis_g43), G43XY=as.character(g43XY_fbias)), filename =NULL,
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1)
grid.arrange(gTree(children=venn.plot1),ncol = 1 )
#overlap between G43 female biased genes and XY female biased genes.
venn.plot1 <- venn.diagram(list(XX=as.character(fbis_g43), XY=as.character(g43XY_fbias)), filename =NULL,
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1)
grid.arrange(gTree(children=venn.plot1),ncol = 1 )
venn_fbias_out <- arrangeGrob(gTree(children=venn.plot1),ncol = 1 )
ggsave(file="g43_XYXXfemale_fembias.pdf", venn_fbias_out, path = "/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/")
##dnds for sex-biased genes from XX males at G46.
XX_sbun_dnds <- read.table("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/g46_sbun_dnds.txt", header = T)
str(XX_sbun_dnds)
ggplot(XX_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","blue","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(XX_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","blue","grey")) +
theme(legend.position="none") +
ylim(0,2) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(XX_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","blue","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(XX_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
pdf("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/XXg46_sbun_dnds.pdf",width=8, height=8)
ggplot(XX_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
wilcox.test(XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='unbias'], XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='female']) #W = 21448, p-value = 0.002132
wilcox.test(XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='unbias'], XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='male']) #W = 21448, p-value = 0.002132
wilcox.test(XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='male'], XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='female']) #W = 21448, p-value = 0.002132
g46XX_fbias <- read.table("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/g46_fbias_list.txt", header = TRUE)
g46XX_mbias <- read.table("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/g46_mbias_list.txt", header = TRUE)
fbis_g23 <- fivestages_fbias$trans[fivestages_fbias$stage=='G23']
fbis_g27 <- fivestages_fbias$trans[fivestages_fbias$stage=='G27']
fbis_g31 <- fivestages_fbias$trans[fivestages_fbias$stage=='G31']
fbis_g43 <- fivestages_fbias$trans[fivestages_fbias$stage=='G43']
fbis_g46 <- fivestages_fbias$trans[fivestages_fbias$stage=='G46']
##overlap between G46 femael bias and XX female bias
venn.plot1 <- venn.diagram(list(G46=as.character(fbis_g46), XXmale=as.character(g46XX_fbias)), filename =NULL,
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1)
##overlap between G46 femael bias and XX female bias
venn.plot2 <- venn.diagram(list(G46=as.character(fbis_g46), XXmale=as.character(g46XX_fbias)), filename =NULL,
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1)
grid.arrange(gTree(children=venn.plot2),ncol = 1 )
fbis_g46
g46XX_fbias
fbis_g46
##overlap between G46 femael bias and XX female bias
venn.plot2 <- venn.diagram(list(G46=as.character(fbis_g46), XXmale=as.character(g46XX_fbias)), filename =NULL,
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1)
grid.arrange(gTree(children=venn.plot2),ncol = 1 )
#for shared female-biased genes
fivestages_fbias <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Tvedora_dev_RNAseq/input/sexbias_female.txt", header = TRUE)
str(fivestages_fbias)
g43XY_fbias <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Tvedora_dev_RNAseq/input/XY_fbias.txt", header = TRUE)
str(g43XY_fbias)
fbis_g46 <- fivestages_fbias$trans[fivestages_fbias$stage=='G46']
fbis_g43 <- fivestages_fbias$trans[fivestages_fbias$stage=='G43']
fbis_g43
g43XY_fbias
#for shared female-biased genes
fivestages_fbias <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Tvedora_dev_RNAseq/input/sexbias_female_inclusr.txt", header = TRUE)
str(fivestages_fbias)
fbis_g23 <- fivestages_fbias$trans[fivestages_fbias$stage=='G23']
fbis_g27 <- fivestages_fbias$trans[fivestages_fbias$stage=='G27']
fbis_g31 <- fivestages_fbias$trans[fivestages_fbias$stage=='G31']
fbis_g43 <- fivestages_fbias$trans[fivestages_fbias$stage=='G43']
fbis_g46 <- fivestages_fbias$trans[fivestages_fbias$stage=='G46']
fbis_g43xy <- fivestages_fbias$trans[fivestages_fbias$stage=='G43XY']
fbis_g46xx <- fivestages_fbias$trans[fivestages_fbias$stage=='G46XX']
#overlap between G43 female biased genes and XY female biased genes.
venn.plot1 <- venn.diagram(list(XX=as.character(fbis_g43), XY=as.character(fbis_g43xy)), filename =NULL,
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1)
grid.arrange(gTree(children=venn.plot1),ncol = 1 )
#overlap between G43 female biased genes and XY female biased genes.
venn.plot1 <- venn.diagram(list(G43=as.character(fbis_g43), G43XY=as.character(fbis_g43xy)), filename =NULL,
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1)
grid.arrange(gTree(children=venn.plot1),ncol = 1 )
#overlap between G43 female biased genes and XY female biased genes.
venn.plot1 <- venn.diagram(list(G43=as.character(fbis_g43), G43XY=as.character(fbis_g43xy)), filename =NULL,
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1,rotation.degree = 60)
grid.arrange(gTree(children=venn.plot1),ncol = 1 )
fbis_g43xy
#overlap between G43 female biased genes and XY female biased genes.
venn.plot1 <- venn.diagram(list(G43=as.character(fbis_g43), G43XY=as.character(fbis_g43xy)), filename =NULL,
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1,rotation.degree = 60)
grid.arrange(gTree(children=venn.plot1),ncol = 1 )
venn_fbias_out <- arrangeGrob(gTree(children=venn.plot1),ncol = 1 )
ggsave(file="g43_XYXXfemale_fembias.pdf", venn_fbias_out, path = "/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/")
##overlap between G46 femael bias and XX female bias
venn.plot2 <- venn.diagram(list(G46=as.character(fbis_g46), G46XX=as.character(fbis_g46xx)), filename =NULL,
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1,rotation.degree = 60)
grid.arrange(gTree(children=venn.plot2),ncol = 1 )
##overlap between G46 femael bias and XX female bias
venn.plot2 <- venn.diagram(list(G46=as.character(fbis_g46), G46XX=as.character(fbis_g46xx)), filename =NULL,
fill=c("orange","red"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1,rotation.degree = 60)
grid.arrange(gTree(children=venn.plot2),ncol = 1 )
venn_fbias_out <- arrangeGrob(gTree(children=venn.plot2),ncol = 1 )
ggsave(file="g46_XXmale_fembias.pdf", venn_fbias_out, path = "/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/")
#for shared male-biased genes
mbias <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Tvedora_dev_RNAseq/input/share_mbias_incluesr.txt", header = TRUE)
str(mbias)
mbis_g27 <- mbias$trans[mbias$stage=='G27']
mbis_g31 <- mbias$trans[mbias$stage=='G31']
mbis_g43 <- mbias$trans[mbias$stage=='G43']
mbis_g46 <- mbias$trans[mbias$stage=='G46']
mbis_g46xx <- mbias$trans[mbias$stage=='G46XX']
#overlap between male bias and G46 male biased genes.
venn.plot.3 <- venn.diagram(list(G46=as.character(mbis_g46), G46=as.character(mbis_g46xx)), filename =NULL,
fill=c("green","blue"),
ext.line.lwd = 3,
cex = 2,
cat.cex = 2.5)
grid.arrange(gTree(children=venn.plot.3),ncol = 1 )
#overlap between male bias and G46 male biased genes.
venn.plot.3 <- venn.diagram(list(G46=as.character(mbis_g46), G46=as.character(mbis_g46xx)), filename =NULL,
fill=c("green","blue"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1,rotation.degree = 60)
grid.arrange(gTree(children=venn.plot.3),ncol = 1 )
#overlap between male bias and G46 male biased genes.
venn.plot.3 <- venn.diagram(list(G46=as.character(mbis_g46), G46XX=as.character(mbis_g46xx)), filename =NULL,
fill=c("green","blue"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1,rotation.degree = 60)
grid.arrange(gTree(children=venn.plot.3),ncol = 1 )
#overlap between male bias and G46 male biased genes.
venn.plot.3 <- venn.diagram(list(G46=as.character(mbis_g46), G46XX=as.character(mbis_g46xx)), filename =NULL,
fill=c("green","blue"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1,rotation.degree = 60)
grid.arrange(gTree(children=venn.plot.3),ncol = 1 )
venn_mbias_out <- arrangeGrob(gTree(children=venn.plot.2),ncol = 1 )
ggsave(file="g46_xxmale_mbias.pdf", venn_mbias_out, path = "/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/")
share_dnds_4346 <- read.table("/Users/Wen-Juan/git/rana_transcriptome/input/dnds/share_sb_unbias_4346.txt", header = T)
str(share_dnds_4346)
##dnds for female-biased genes from XY females.
XY_sbun_dnds <- read.table("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/XY_unsb_dnds.txt", header = T)
str(XY_sbun_dnds)
ggplot(XY_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
pdf("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/XY_sbun_dnds.pdf",width=8, height=8)
ggplot(XY_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
wilcox.test(XY_sbun_dnds$dnds[XY_sbun_dnds$bias=='unbias'], XY_sbun_dnds$dnds[XY_sbun_dnds$bias=='female']) #W = 21448, p-value = 0.002132
##dnds for sex-biased genes from XX males at G46.
XX_sbun_dnds <- read.table("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/g46_sbun_dnds.txt", header = T)
str(XX_sbun_dnds)
ggplot(XX_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
pdf("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/XXg46_sbun_dnds.pdf",width=8, height=8)
ggplot(XX_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
wilcox.test(XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='unbias'], XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='female']) #W = 2013400, p-value = 0.7805
wilcox.test(XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='unbias'], XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='male']) #W = 314860, p-value = 0.06985
wilcox.test(XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='male'], XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='female']) #W = 193950, p-value = 0.06187
#overlap between male bias and G46 male biased genes.
venn.plot.3 <- venn.diagram(list(G46=as.character(mbis_g46), G46XX=as.character(mbis_g46xx)), filename =NULL,
fill=c("green","blue"),
ext.line.lwd = 2,
cex = 1,
cat.cex = 1,rotation.degree = 60)
grid.arrange(gTree(children=venn.plot.3),ncol = 1 )
venn_mbias_out <- arrangeGrob(gTree(children=venn.plot.3),ncol = 1 )
ggsave(file="g46_xxmale_mbias.pdf", venn_mbias_out, path = "/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/")
venn_mbias_out <- arrangeGrob(gTree(children=venn.plot.3),ncol = 1 )
ggsave(file="g46_xxmale_mbias.pdf", venn_mbias_out, path = "/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/")
##dnds for sex-biased genes from XX males at G46.
XX_sbun_dnds <- read.table("/Users/Wen-Juan/my_postdoc/postdoc_manuscripts/WMa_publication/RNAseq_tv/final_figures/additional_file1/extra/g46_sbun_dnds.txt", header = T)
str(XX_sbun_dnds)
ggplot(XX_sbun_dnds, aes(x=bias, y=dnds, fill=bias)) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
ylim(0,0.9) +
geom_boxplot() +
labs(x='Sex bias', y='dN/dS') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
wilcox.test(XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='unbias'], XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='female']) #W = 1166900, p-value = 0.3559
wilcox.test(XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='unbias'], XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='male']) #W = 182880, p-value = 0.1689
wilcox.test(XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='male'], XX_sbun_dnds$dnds[XX_sbun_dnds$bias=='female']) #W = 193950, p-value = 0.06187
