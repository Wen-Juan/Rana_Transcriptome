library(plyr)
install.packages("devtools")
library(devtools)
install_github("easyGgplot2", "kassambara")
library(easyGgplot2)
#set up the working directory
setwd("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/")
#results directoy
setwd("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/")
library(ggplot2)
library(plyr)
install.packages("devtools")
library(devtools)
install_github("easyGgplot2", "kassambara")
library(easyGgplot2)
install.packages("devtools")
#set up the working directory
setwd("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/dnds")
#results directoy
setwd("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/")
dn_ds_all<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/dnds/all_dnds_exp_sorted.txt", header = T)
str(dn_ds_all)
#boxplot
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dnds_all.pdf")
ggplot(dn_ds_all, aes(x=sexbias, y=dnds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Un"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1)) +
theme(axis.title.x = element_text(size=12,colour = "black"),axis.title.y = element_text(size=12,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=10),axis.text.y = element_text(colour="black",size=10))
dev.off()
dn_ds_all<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/dnds/all_dnds_exp_sorted.txt", header = T)
str(dn_ds_all)
#boxplot
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dnds_all.pdf")
ggplot(dn_ds_all, aes(x=sexbias, y=dnds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Un"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1)) +
theme(axis.title.x = element_text(size=12,colour = "black"),axis.title.y = element_text(size=12,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=10),axis.text.y = element_text(colour="black",size=10))
dev.off()
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_ds_all.pdf")
ggplot(dn_ds_all, aes(x=sexbias, y=dnds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
G31 <- subset(dn_ds_all, dn_ds_all$stage=='G31')
G43 <- subset(dn_ds_all, dn_ds_all$stage=='G43')
G46 <- subset(dn_ds_all, dn_ds_all$stage=='G46')
#G43
wilcox.test(G43$dnds[G43$sexbias=='febias'], G43$dnds[G43$sexbias=='mbias']) # NA
#G43
wilcox.test(G43$dnds[G43$sexbias=='female'], G43$dnds[G43$sexbias=='male']) # NA
sex_auto<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/dnds/sexchr_auto_dnds_all.txt", header = T)
str(sex_auto)
head(sex_auto)
#dn/ds plot for Faster-X
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX.pdf")
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
sex_auto<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/dnds/sexchr_auto_dnds_all.txt", header = T)
str(sex_auto)
head(sex_auto)
#dn/ds plot for Faster-X
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX.pdf")
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrtype)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
#dn/ds plot for Faster-X
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX.pdf")
ggplot(sex_auto, aes(x=chrtype, y=dNdS, fill=chrtype)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
#dn/ds plot for Faster-X
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX.pdf")
ggplot(sex_auto, aes(x=chrtype, y=dNdS, fill=chrtype)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
ylim(0,0.5) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
###if separate to compare Chr01, Chr02 and autosome
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX_chr0102.pdf")
###if separate to compare Chr01, Chr02 and autosome
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX_chr0102.pdf")
ggplot(sex_auto, aes(x=twosexchr, y=dNdS, fill=twosexchr)) +
scale_fill_manual(values = c("grey","firebrick2","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
ylim(0,0.5) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Chr01","Chr02")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
#dn/ds plot for Faster-X
###all chromosome separately
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX_10chr.pdf")
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey","grey","grey","grey","grey","grey","grey","grey")) +
theme(legend.position="none") +
geom_boxplot() +
ylim(0,0.5) +
labs(x='Chromosome', y='dn/ds') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
mean(sex_auto$dNdS[sex_auto$chr=='Chr01'])  #0.08347266
mean(sex_auto$dNdS[sex_auto$chrid=='Chr01'])  #0.08347266
mean(sex_auto$dNdS[sex_auto$chrid=='Chr02']) #0.08477808
mean(sex_auto$dNdS[sex_auto$chrid=='Autosome'])  #0.08184848
mean(sex_auto$dNdS[sex_auto$chrtype=='Autosome'])  #0.08184848
str(sex_auto)
wilcox.test(sex_auto$dNdS[sex_auto$twosexchr=='Autosome'], sex_auto$dNdS[sex_auto$twosexchr=='Chr01'])
#W = 2745200, p-value = 0.2957
wilcox.test(sex_auto$dNdS[sex_auto$twosexchr=='Chr02'], sex_auto$dNdS[sex_auto$twosexchr=='Autosome'])
#W = 2453400, p-value = 0.06201
wilcox.test(sex_auto$dNdS[sex_auto$twosexchr=='Chr01'], sex_auto$dNdS[sex_auto$twosexchr=='Chr02'])
#G46
qqnorm(log(dn_ds$dNdS)) #unlikely normal distribution
dn_ds_all<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/dnds/all_dnds_exp_sorted.txt", header = T)
str(dn_ds_all)
#boxplot
#dn/ds
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dnds_all.pdf")
ggplot(dn_ds_all, aes(x=sexbias, y=dnds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#dn
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_ds_all.pdf")
ggplot(dn_ds_all, aes(x=sexbias, y=ds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#ds
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_ds_all.pdf")
ggplot(dn_ds_all, aes(x=sexbias, y=ds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
ggplot(dn_ds_all, aes(x=sexbias, y=dn,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#ds
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_ds_all.pdf")
ggplot(dn_ds_all, aes(x=sexbias, y=ds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2.5)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#ds
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_ds_all.pdf")
ggplot(dn_ds_all, aes(x=sexbias, y=ds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#boxplot
#dn/ds
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dnds_all.pdf")
ggplot(dn_ds_all, aes(x=sexbias, y=dnds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,0.7)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#boxplot
#dn/ds
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dnds_all.pdf")
ggplot(dn_ds_all, aes(x=sexbias, y=dnds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,0.6)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#dn
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dn_all.pdf")
ggplot(dn_ds_all, aes(x=sexbias, y=dn,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,0.6)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#dn
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dn_all.pdf")
ggplot(dn_ds_all, aes(x=sexbias, y=dn,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,0.8)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#dn
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dn_all.pdf")
ggplot(dn_ds_all, aes(x=sexbias, y=dn,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,1)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
str(dn_ds_all)
G31 <- subset(dn_ds_all, dn_ds_all$stage=='G31')
G43 <- subset(dn_ds_all, dn_ds_all$stage=='G43')
G46 <- subset(dn_ds_all, dn_ds_all$stage=='G46')
#G43
wilcox.test(G43$dnds[G43$sexbias=='female'], G43$dnds[G43$sexbias=='male']) # W = 60, p-value = 0.9149
wilcox.test(G43$dnds[G43$sexbias=='female'], G43$dnds[G43$sexbias=='unbias']) #w=146,740,p=2.357e-06
wilcox.test(G43$dnds[G43$sexbias=='male'], G43$dnds[G43$sexbias=='unbias']) #W=46,368, P=0.0001
wilcox.test(G43$dnds[G43$sexbias=='male'], G43$dnds[G43$sexbias=='unbias']) #W=46,368, P=0.0001
G43$dnds[G43$sexbias=='male']
G43
wilcox.test(G43$dnds[G43$sexbias=='male'], G43$dnds[G43$sexbias=='unbias']) #W=46,368, P=0.0001
wilcox.test(G46$dnds[G46$sexbias=='male'], G46$dnds[G46$sexbias=='unbias']) #W=400, P=0.50
wilcox.test(G46$dnds[G46$sexbias=='female'], G46$dnds[G46$sexbias=='unbias']) #w=149,610,p=4.37e-07
wilcox.test(G46$dnds[G46$sexbias=='female'], G46$dnds[G46$sexbias=='male']) #W=45,380, P=0.0003
G31
#G31
wilcox.test(G31$dnds[G31$sexbias=='female'], G31$dnds[G31$sexbias=='unbias']) #W = 202960, p-value = 6.255e-06
#gonad
wilcox.test(Gonad$dnds[gonad$sexbias=='male'], gonad$dnds[gonad$sexbias=='unbias']) #W = 441010, p-value = 8.044e-08
gonad <- subset(dn_ds_all, dn_ds_all$stage=='Gonad')
liver <- subset(dn_ds_all, dn_ds_all$stage=='Liver')
brain <- subset(dn_ds_all, dn_ds_all$stage=='Brain')
#gonad
wilcox.test(gonad$dnds[gonad$sexbias=='male'], gonad$dnds[gonad$sexbias=='unbias']) #W = 441010, p-value = 8.044e-08
wilcox.test(gonad$dnds[gonad$sexbias=='female'], gonad$dnds[gonad$sexbias=='unbias']) #W = 4095500, p-value = 0.1994
wilcox.test(gonad$dnds[gonad$sexbias=='female'], gonad$dnds[gonad$sexbias=='male']) #W = 95099, p-value = 3.095e-06
#brain
wilcox.test(brain$dnds[brain$sexbias=='male'], brain$dnds[brain$sexbias=='unbias']) #W = 441010, p-value = 8.044e-08
wilcox.test(brain$dnds[brain$sexbias=='female'], brain$dnds[brain$sexbias=='unbias']) #W = 4095500, p-value = 0.1994
wilcox.test(brain$dnds[brain$sexbias=='female'], brain$dnds[brain$sexbias=='male']) #W = 95099, p-value = 3.095e-06
#liver
wilcox.test(liver$dnds[liver$sexbias=='male'],liver$dnds[liver$sexbias=='unbias']) #W = 441010, p-value = 8.044e-08
wilcox.test(liver$dnds[liver$sexbias=='female'],liver$dnds[liver$sexbias=='unbias']) #W = 4095500, p-value = 0.1994
wilcox.test(liver$dnds[liver$sexbias=='female'],liver$dnds[liver$sexbias=='male']) #W = 95099, p-value = 3.095e-06
liver
brain
G43
#boxplot
#dn/ds
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dnds_all.pdf", width=10)
ggplot(dn_ds_all, aes(x=sexbias, y=dnds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,0.6)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#dn
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dn_all.pdf", width=10)
ggplot(dn_ds_all, aes(x=sexbias, y=dn,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,1)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#ds
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_ds_all.pdf", width=10)
ggplot(dn_ds_all, aes(x=sexbias, y=ds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#boxplot
#dn/ds
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dnds_all.pdf", width=10)
ggplot(dn_ds_all, aes(x=sexbias, y=dnds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,0.6)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#ds
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_ds_all.pdf", width=10)
ggplot(dn_ds_all, aes(x=sexbias, y=ds,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#dn
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dn_all.pdf", width=10)
ggplot(dn_ds_all, aes(x=sexbias, y=dn,fill=(sexbias))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN", limits = c(0,1)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#gonad
wilcox.test(gonad$dnds[gonad$sexbias=='male'], gonad$dnds[gonad$sexbias=='unbias']) #W = 103310, p-value = 0.1372
wilcox.test(gonad$dnds[gonad$sexbias=='female'], gonad$dnds[gonad$sexbias=='unbias']) #W = 24332, p-value = 0.1197
wilcox.test(gonad$dnds[gonad$sexbias=='female'], gonad$dnds[gonad$sexbias=='male']) #W = 1349300, p-value = 0.3569
#brain
wilcox.test(brain$dnds[brain$sexbias=='male'], brain$dnds[brain$sexbias=='unbias']) #W = 441010, p-value = 8.044e-08
wilcox.test(brain$dnds[brain$sexbias=='male'], brain$dnds[brain$sexbias=='unbias'])
wilcox.test(brain$dnds[brain$sexbias=='female'], brain$dnds[brain$sexbias=='unbias'])
wilcox.test(brain$dnds[brain$sexbias=='female'], brain$dnds[brain$sexbias=='male']) #W = 74, p-value = 0.04881
#G43
wilcox.test(G43$dnds[G43$sexbias=='female'], G43$dnds[G43$sexbias=='male']) # W = 60, p-value = 0.9149
wilcox.test(G43$dnds[G43$sexbias=='female'], G43$dnds[G43$sexbias=='unbias']) #W = 202960, p-value = 6.255e-06
wilcox.test(G43$dnds[G43$sexbias=='male'], G43$dnds[G43$sexbias=='unbias']) #W = 14262, p-value = 0.2533. This is not correct, as only 3 male values.
#G46
wilcox.test(G46$dnds[G46$sexbias=='male'], G46$dnds[G46$sexbias=='unbias']) #W = 441010, p-value = 8.044e-08
wilcox.test(G46$dnds[G46$sexbias=='female'], G46$dnds[G46$sexbias=='unbias']) #W = 4095500, p-value = 0.1994
wilcox.test(G46$dnds[G46$sexbias=='female'], G46$dnds[G46$sexbias=='male']) #W = 95099, p-value = 3.095e-06
#gonad
wilcox.test(gonad$dnds[gonad$sexbias=='male'], gonad$dnds[gonad$sexbias=='unbias']) #W = 1855500, p-value = 0.06863
wilcox.test(gonad$dnds[gonad$sexbias=='female'], gonad$dnds[gonad$sexbias=='unbias']) #W = 2430100, p-value = 0.002517
wilcox.test(gonad$dnds[gonad$sexbias=='female'], gonad$dnds[gonad$sexbias=='male']) #W = 1349300, p-value = 0.3569
#brain
wilcox.test(brain$dnds[brain$sexbias=='male'], brain$dnds[brain$sexbias=='unbias']) #W = 441010, p-value = 8.044e-08
brain
#brain
wilcox.test(brain$dnds[brain$sexbias=='male'], brain$dnds[brain$sexbias=='unbias']) #W = 441010, p-value = 8.044e-08
wilcox.test(brain$dnds[brain$sexbias=='female'], brain$dnds[brain$sexbias=='unbias']) #W = 4095500, p-value = 0.1994
wilcox.test(brain$dnds[brain$sexbias=='female'], brain$dnds[brain$sexbias=='male']) #W = 74, p-value = 0.04881
#liver
wilcox.test(liver$dnds[liver$sexbias=='male'],liver$dnds[liver$sexbias=='unbias']) #W = 123380, p-value = 0.005197
wilcox.test(liver$dnds[liver$sexbias=='female'],liver$dnds[liver$sexbias=='unbias']) #W = 81166, p-value = 0.0796
wilcox.test(liver$dnds[liver$sexbias=='female'],liver$dnds[liver$sexbias=='male']) #W = 426.5, p-value = 0.7359
#set working directory
datapath <- '/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/'
results <- '/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/'
#loading data
Amm_all_TPM <-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/Amm_all_TPM.txt",header = T)
str(Amm_all_TPM)
g46_tau <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/G46_tau/G46_sb_un_tau_match_fi.txt", header = TRUE)
str(g46_tau)
?lm
y <- lm(tau~logFC.XY46.XX46*bias, g46_tau)
anova(y)
###########
#for sex-biased genes and tau in gonad tissues
##########
##boxplot
gonad_tau <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/Gonad_tau/gonad_fc1_sb_unbias_tau.txt", header = TRUE)
str(gonad_tau)
y <- lm(tau~logFC.XYtestis.XXovary*bias, gonad_tau)
anova(y)
##correlation scatter plot
abs_gonad_tau <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/Gonad_tau/gonad_fc1_abssb_unbias_tau.txt", header = TRUE)
str(abs_gonad_tau)
###########
#for sex-biased genes and tau in gonad tissues
##########
##boxplot
gonad_tau <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/Gonad_tau/gonad_fc1_sb_unbias_tau.txt", header = TRUE)
str(gonad_tau)
##########
#####gonad tau and dnds
##########
gonad_tau_dnds <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/Gonad_tau/gonad_fc1_tau_dnds_subset_sorted.txt", header = TRUE)
str(gonad_tau_dnds)
###linear model to investigate whether evolutionary rate is explained by tau or sex bias, or the interaction.
y1 <- lm(dNdS ~ tau * bias, gonad_tau_dnds)
anova(y1)
#scatter plot
abs_g46_tau <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/G46_tau/G46_abssb_un_tau_match_fi.txt", header = TRUE)
str(abs_g46_tau)
y2 <- (dNdS ~ tau * abslogFC.XY46.XX46, gonad_tau_dnds)
y2 <- lm(dNdS ~ tau * abslogFC.XY46.XX46, gonad_tau_dnds)
y2 <- lm(dNdS ~ tau * logFC.XY46.XX46, gonad_tau_dnds)
str(gonad_tau_dnds)
y2 <- lm(dNdS ~ tau * logFC.XYtestis.XXovary, gonad_tau_dnds)
anova(y2)
?
<-
?glm
y2 <- glm(dNdS ~ tau * logFC.XYtestis.XXovary, family=quasipoisson, gonad_tau_dnds)
anova(y2)
anova(y2)
summary(y2)
y1a <- glm(dNdS ~ tau * bias,family=quasipoisson, gonad_tau_dnds)
anova(y1a)
summary(y1a)
y1a <- glm(dNdS ~ tau * bias,family=quasibinomial, gonad_tau_dnds)
summary(y1a)
y1a <- glm(dNdS ~ tau * bias,family=quasipoisson, gonad_tau_dnds)
summary(y1a)
y2 <- glm(dNdS ~ tau * logFC.XYtestis.XXovary, family=quasipoisson, gonad_tau_dnds)
summary(y2)
g46_tau <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/G46_tau/G46_sb_un_tau_match_fi.txt", header = TRUE)
str(g46_tau)
##correlation scatter plot
abs_gonad_tau <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/Gonad_tau/gonad_fc1_abssb_unbias_tau.txt", header = TRUE)
str(abs_gonad_tau)
##########
#####gonad tau and dnds
##########
gonad_tau_dnds <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/Gonad_tau/gonad_fc1_tau_dnds_subset_sorted.txt", header = TRUE)
str(gonad_tau_dnds)
g46_tau <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/G46_tau/G46_sb_un_tau_match_fi.txt", header = TRUE)
str(g46_tau)
pdf("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/tau/tau_amm_g46.pdf", width=8, height=8)
ggplot(g46_tau, aes(x=bias, y=tau, fill=bias)) + scale_fill_manual(values = c("firebrick2","dodgerblue2","grey40"), name="Sex bias",labels=c("XX","XY","unbias")) +
geom_boxplot() +
labs(x='Sex bias', y='Tau')
dev.off()
####liner model to investigate whether tau is correlated with gene expression and sex bias.
hist(g46_tau$sqrt(abs(logFC.XY46.XX46)))
logFC.XY46.XX46
####liner model to investigate whether tau is correlated with gene expression and sex bias.
hist(g46_tau$logFC.XY46.XX46)
