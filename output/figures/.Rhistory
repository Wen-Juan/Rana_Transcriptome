scale_x_discrete(labels=c("F", "M"),name="Sex bias") +
scale_y_continuous(name = "Number of genes", limits = c(0,6500)) +
theme(axis.title.x = element_text(size=15,colour = "black"),axis.title.y = element_text(size=15,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
par(mar=c(5,2,4,2))
ggplot(data = sb, aes(x=Sex_bias, y= Gene_number, fill=interaction(factor(Fold_change),Sex_bias), label=Gene_number)) +
geom_bar(stat="identity") +
scale_fill_manual(values = c(reds,blues), name="Fold change",labels=c("FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3","FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3")) +
facet_grid(~Gosner_stage) +
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_x_discrete(labels=c("F", "M"),name="Sex bias") +
scale_y_continuous(name = "Number of genes", limits = c(0,6500)) +
theme(axis.title.x = element_text(size=15,colour = "black"),axis.title.y = element_text(size=15,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
par(mar=c(3,2,3,2))
ggplot(data = sb, aes(x=Sex_bias, y= Gene_number, fill=interaction(factor(Fold_change),Sex_bias), label=Gene_number)) +
geom_bar(stat="identity") +
scale_fill_manual(values = c(reds,blues), name="Fold change",labels=c("FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3","FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3")) +
facet_grid(~Gosner_stage) +
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_x_discrete(labels=c("F", "M"),name="Sex bias") +
scale_y_continuous(name = "Number of genes", limits = c(0,6500)) +
theme(axis.title.x = element_text(size=15,colour = "black"),axis.title.y = element_text(size=15,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
par(mar=c(5,5,5,5))
ggplot(data = sb, aes(x=Sex_bias, y= Gene_number, fill=interaction(factor(Fold_change),Sex_bias), label=Gene_number)) +
geom_bar(stat="identity") +
scale_fill_manual(values = c(reds,blues), name="Fold change",labels=c("FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3","FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3")) +
facet_grid(~Gosner_stage) +
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_x_discrete(labels=c("F", "M"),name="Sex bias") +
scale_y_continuous(name = "Number of genes", limits = c(0,6500)) +
theme(axis.title.x = element_text(size=15,colour = "black"),axis.title.y = element_text(size=15,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
par(mar=c(5,10,5,10))
ggplot(data = sb, aes(x=Sex_bias, y= Gene_number, fill=interaction(factor(Fold_change),Sex_bias), label=Gene_number)) +
geom_bar(stat="identity") +
scale_fill_manual(values = c(reds,blues), name="Fold change",labels=c("FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3","FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3")) +
facet_grid(~Gosner_stage) +
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_x_discrete(labels=c("F", "M"),name="Sex bias") +
scale_y_continuous(name = "Number of genes", limits = c(0,6500)) +
theme(axis.title.x = element_text(size=15,colour = "black"),axis.title.y = element_text(size=15,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
par(mar=c(5,1,5,1))
ggplot(data = sb, aes(x=Sex_bias, y= Gene_number, fill=interaction(factor(Fold_change),Sex_bias), label=Gene_number)) +
geom_bar(stat="identity") +
scale_fill_manual(values = c(reds,blues), name="Fold change",labels=c("FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3","FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3")) +
facet_grid(~Gosner_stage) +
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_x_discrete(labels=c("F", "M"),name="Sex bias") +
scale_y_continuous(name = "Number of genes", limits = c(0,6500)) +
theme(axis.title.x = element_text(size=15,colour = "black"),axis.title.y = element_text(size=15,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
par(mar=c(5,4,4,2))
ggplot(data = sb, aes(x=Sex_bias, y= Gene_number, fill=interaction(factor(Fold_change),Sex_bias), label=Gene_number)) +
geom_bar(stat="identity") +
scale_fill_manual(values = c(reds,blues), name="Fold change",labels=c("FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3","FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3")) +
facet_grid(~Gosner_stage) +
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_x_discrete(labels=c("F", "M"),name="Sex bias") +
scale_y_continuous(name = "Number of genes", limits = c(0,6500)) +
theme(axis.title.x = element_text(size=15,colour = "black"),axis.title.y = element_text(size=15,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
pdf("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/sex_bias_alltissues.pdf",height=10, width=12)
ggplot(data = sb, aes(x=Sex_bias, y= Gene_number, fill=interaction(factor(Fold_change),Sex_bias), label=Gene_number)) +
geom_bar(stat="identity") +
scale_fill_manual(values = c(reds,blues), name="Fold change",labels=c("FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3","FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3")) +
facet_grid(~Gosner_stage) +
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_x_discrete(labels=c("F", "M"),name="Sex bias") +
scale_y_continuous(name = "Number of genes", limits = c(0,6500)) +
theme(axis.title.x = element_text(size=15,colour = "black"),axis.title.y = element_text(size=15,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
par(mar=c(5,3,3,4))
pdf("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/sex_bias_alltissues.pdf",height=10, width=12)
ggplot(data = sb, aes(x=Sex_bias, y= Gene_number, fill=interaction(factor(Fold_change),Sex_bias), label=Gene_number)) +
geom_bar(stat="identity") +
scale_fill_manual(values = c(reds,blues), name="Fold change",labels=c("FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3","FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3")) +
facet_grid(~Gosner_stage) +
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_x_discrete(labels=c("F", "M"),name="Sex bias") +
scale_y_continuous(name = "Number of genes", limits = c(0,6500)) +
theme(axis.title.x = element_text(size=15,colour = "black"),axis.title.y = element_text(size=15,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
par(mar=c(5,1,3,5))
pdf("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/sex_bias_alltissues.pdf",height=10, width=12)
ggplot(data = sb, aes(x=Sex_bias, y= Gene_number, fill=interaction(factor(Fold_change),Sex_bias), label=Gene_number)) +
geom_bar(stat="identity") +
scale_fill_manual(values = c(reds,blues), name="Fold change",labels=c("FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3","FDR ≤0.05","0< Log2 ≤1","1< Log2 ≤2","2< Log2 ≤3")) +
facet_grid(~Gosner_stage) +
geom_text(size = 3, position = position_stack(vjust = 0.5)) +
scale_x_discrete(labels=c("F", "M"),name="Sex bias") +
scale_y_continuous(name = "Number of genes", limits = c(0,6500)) +
theme(axis.title.x = element_text(size=15,colour = "black"),axis.title.y = element_text(size=15,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
sex_auto<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/dnds/all_dnds_exp_sorted.txt", header = T)
sex_auto<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/dnds/amm88perc_annotation_dnds.txt", header = T)
str(sex_auto)
head(sex_auto)
dn_ds_all_shareunbias<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/5tissues_sb_shareunbias_dnds_sorted.txt", header = T)
str(dn_ds_all_shareunbias)
sex_auto<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/dnds/amm88perc_annotation_dnds.txt", header = T)
str(sex_auto)
head(sex_auto)
ggplot(sex_auto, aes(x=chr, y=dnds, fill=chr)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey","grey","grey","grey","grey","grey","grey","grey")) +
theme(legend.position="none") +
geom_boxplot(notch = TRUE) +
ylim(0,0.5) +
labs(x='Chromosome', y='dn/ds') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto, aes(x=chr, y=dnds, fill=chr)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey","grey","grey","grey","grey","grey","grey","grey")) +
theme(legend.position="none") +
geom_boxplot(notch = TRUE) +
ylim(0,1) +
labs(x='Chromosome', y='dn/ds') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
#dn/ds plot for Faster-X
###all chromosome separately
sex_auto1 <- subset(sex_auto,sex_auto$chr!='NA')
ggplot(sex_auto1, aes(x=chr, y=dnds, fill=chr)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey","grey","grey","grey","grey","grey","grey","grey")) +
theme(legend.position="none") +
geom_boxplot(notch = TRUE) +
ylim(0,1) +
labs(x='Chromosome', y='dn/ds') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX_10chr.pdf", width=10)
ggplot(sex_auto1, aes(x=chr, y=dnds, fill=chr)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey","grey","grey","grey","grey","grey","grey","grey")) +
theme(legend.position="none") +
geom_boxplot(notch = TRUE) +
ylim(0,1) +
labs(x='Chromosome', y='dn/ds') +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
ylim(0,0.5) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
ylim(0,0.5) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
ylim(0,1) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot() +
ylim(0,1) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot(notch=TRUE) +
ylim(0,1) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot(notch=TRUE) +
ylim(0,7) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot(notch=TRUE) +
ylim(0,0.7) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot(notch=TRUE) +
ylim(0,0.6) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot(notch=TRUE) +
ylim(0,0.5) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot(notch=TRUE) +
ylim(0,0.5) +
labs(x='Chromosome', y='dn/ds') +
# scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot(notch=TRUE) +
ylim(0,0.3) +
labs(x='Chromosome', y='dn/ds') +
# scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot(notch=TRUE) +
ylim(0,0.6) +
labs(x='Chromosome', y='dn/ds') +
# scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
#sex chromosome vs autosomes
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX_autog.pdf")
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("firebrick2","firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot(notch=TRUE) +
ylim(0,0.6) +
labs(x='Chromosome', y='dn/ds') +
# scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("grey","firebrick2","firebrick2")) +
theme(legend.position="none") +
geom_boxplot(notch=TRUE) +
ylim(0,0.6) +
labs(x='Chromosome', y='dn/ds') +
# scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
#sex chromosome vs autosomes
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX_autog.pdf")
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("grey","firebrick2","firebrick2")) +
theme(legend.position="none") +
geom_boxplot(notch=TRUE) +
ylim(0,0.6) +
labs(x='Chromosome', y='dn/ds') +
# scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
wilcox.test(sex_auto1$dnds[sex_auto1$chrone=='Auto'], sex_auto1$dnds[sex_auto1$chrone=='Chr01'])
#W = 2745200, p-value = 0.2957
wilcox.test(sex_auto1$dnds[sex_auto1$chrone=='Auto'], sex_auto1$dnds[sex_auto1$chrone=='Chr02'])
#W = 2275300, p-value = 0.06201
wilcox.test(sex_auto1$dnds[sex_auto1$chrone=='Chr02'], sex_auto1$dnds[sex_auto1$chrone=='Chr01'])
#sex chromosome vs autosomes
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX_autog.pdf")
ggplot(sex_auto1, aes(x=chrone, y=dnds, fill=chrone)) +
scale_fill_manual(values = c("grey","firebrick2","firebrick2")) +
theme(legend.position="none") +
geom_boxplot(notch=TRUE) +
ylim(0,0.6) +
labs(x='Chromosome', y='dn/ds') +
# scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
library(ggplot2)
library(plyr)
install.packages("devtools")
library(devtools)
install_github("easyGgplot2", "kassambara")
library(easyGgplot2)
#load the corresponding data files.
col1 <- rgb(red = 0, green = 0, blue = 0, alpha = 0.1)
col2 <- rgb(red = 1, green = 0, blue = 0, alpha = 0.6)
install.packages("devtools")
datapath <- '/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/Amg43/'
kdata <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/Amg43/LogCPM_0.05_Amg43 copy.txt",header = T)
str(kdata)
datapath <- '/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/Amg46male/'
kdata <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/Amg46male/LogCPM_0.05_Amg46male copy.txt",header = T)
str(kdata)
kdata <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/Amg46male/LogCPM_0.05_Amg46male copy.txt",header = T)
str(kdata)
group1.expr.minus <- (map.data$Am2_463 + map.data$Am4_461 + map.data$Am6_462) / 3 #XY male group at G46
group1.expr.minus <- (map.data$Am5_461)
map.data <- subset(kdata, kdata$start!='NA')
chr1.1.data <- data.frame(subset(map.data, map.data$chr=='Chr01'))
chr1.2.data <- data.frame(subset(map.data, map.data$chr=='Chr02'))
chr1.data <- rbind(chr1.1.data,chr1.2.data)
chr2.1.data <- subset(map.data, map.data$chr!='Chr01')
chr2.data<- subset(chr2.1.data, chr2.1.data$chr!='Chr02')
group1.expr.minus <- (map.data$Am2_463 + map.data$Am4_461 + map.data$Am6_462) / 3 #XY male group at G46
group1.expr.minus <- (map.data$Am5_461) #Sex reversal XX male
group1.expr <- group1.expr.minus + min(abs(c(group1.expr.minus, group2.expr.minus)))
group2.expr.minus <- (map.data$Am5_461) #Sex reversal XX male
group1.expr <- group1.expr.minus + min(abs(c(group1.expr.minus, group2.expr.minus)))
group2.expr <- group2.expr.minus + min(abs(c(group1.expr.minus, group2.expr.minus)))
map.data$ratio <- log2(group1.expr/group2.expr)
map.data$ratio[mapply(is.infinite, map.data$ratio)] <- NA
col1 <- rgb(red = 0, green = 0, blue = 0, alpha = 0.1)
col2 <- rgb(red = 1, green = 0, blue = 0, alpha = 0.6)
datapath <- '/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/Amg46male/'
kdata <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/Amg46male/LogCPM_0.05_Amg46male copy.txt",header = T)
str(kdata)
map.data <- subset(kdata, kdata$start!='NA')
chr1.1.data <- data.frame(subset(map.data, map.data$chr=='Chr01'))
chr1.2.data <- data.frame(subset(map.data, map.data$chr=='Chr02'))
chr1.data <- rbind(chr1.1.data,chr1.2.data)
chr2.1.data <- subset(map.data, map.data$chr!='Chr01')
chr2.data<- subset(chr2.1.data, chr2.1.data$chr!='Chr02')
group1.expr.minus <- (map.data$Am2_463 + map.data$Am4_461 + map.data$Am6_462) / 3 #XY male group at G46
group2.expr.minus <- (map.data$Am5_461) #Sex reversal XX male
group1.expr <- group1.expr.minus + min(abs(c(group1.expr.minus, group2.expr.minus)))
group2.expr <- group2.expr.minus + min(abs(c(group1.expr.minus, group2.expr.minus)))
map.data$ratio <- log2(group1.expr/group2.expr)
map.data$ratio[mapply(is.infinite, map.data$ratio)] <- NA
ggplot(map.data, aes(x=chr, y=ratio, fill=chr)) +
scale_fill_manual(values = c("red","red","grey","grey","grey","grey","grey","grey","grey","grey")) +
scale_y_continuous(limits = c(-8,8)) +
geom_boxplot() +
theme(legend.position="none") +
labs(x='Chromosome', y='Log2 ratio of XY/XX gene expression') +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
ggplot(map.data, aes(x=chr, y=ratio, fill=chr)) +
scale_fill_manual(values = c("red","red","grey","grey","grey","grey","grey","grey","grey","grey")) +
scale_y_continuous(limits = c(-10,10)) +
geom_boxplot() +
theme(legend.position="none") +
labs(x='Chromosome', y='Log2 ratio of XY/XX gene expression') +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
ggplot(map.data, aes(x=chr, y=ratio, fill=chr)) +
scale_fill_manual(values = c("red","red","grey","grey","grey","grey","grey","grey","grey","grey")) +
scale_y_continuous(limits = c(-6,6)) +
geom_boxplot() +
theme(legend.position="none") +
labs(x='Chromosome', y='Log2 ratio of XY/XX gene expression') +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
#gene expression ratio Log2(XY/XX)
pdf("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/log2ratio_XYXXsexreversal_10chr.pdf", width=8, height=8)
ggplot(map.data, aes(x=chr, y=ratio, fill=chr)) +
scale_fill_manual(values = c("red","red","grey","grey","grey","grey","grey","grey","grey","grey")) +
scale_y_continuous(limits = c(-6,6)) +
geom_boxplot() +
theme(legend.position="none") +
labs(x='Chromosome', y='Log2 ratio of XY/XX gene expression') +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
ggplot(map.data, aes(x=chrone, y=ratio, fill=chrone)) +
scale_fill_manual(values = c("red","red","grey",)) +
scale_y_continuous(limits = c(-6,6)) +
geom_boxplot() +
theme(legend.position="none") +
labs(x='Chromosome', y='Log2 ratio of XY/XX gene expression') +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
ggplot(map.data, aes(x=chrone, y=ratio, fill=chrone)) +
scale_fill_manual(values = c("red","red","grey",)) +
scale_y_continuous(limits = c(-6,6)) +
geom_boxplot() +
theme(legend.position="none") +
labs(x='Chromosome', y='Log2 ratio of XY/XX gene expression') +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
ggplot(map.data, aes(x=chr, y=ratio, fill=chr)) +
scale_fill_manual(values = c("red","red","grey","grey","grey","grey","grey","grey","grey","grey")) +
scale_y_continuous(limits = c(-6,6)) +
geom_boxplot(notch = TRUE) +
theme(legend.position="none") +
labs(x='Chromosome', y='Log2 ratio of XY/XX gene expression') +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
#gene expression ratio Log2(XY/XX)
pdf("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/log2ratio_XYXXsexreversal_10chr.pdf", width=8, height=8)
ggplot(map.data, aes(x=chr, y=ratio, fill=chr)) +
scale_fill_manual(values = c("red","red","grey","grey","grey","grey","grey","grey","grey","grey")) +
scale_y_continuous(limits = c(-6,6)) +
geom_boxplot(notch = TRUE) +
theme(legend.position="none") +
labs(x='Chromosome', y='Log2 ratio of XY/XX gene expression') +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
str(map.data)
ggplot(map.data, aes(x=chrone, y=ratio, fill=chrone)) +
scale_fill_manual(values = c("red","red","grey",)) +
scale_y_continuous(limits = c(-6,6)) +
geom_boxplot(notch = TRUE)
ggplot(map.data, aes(x=chrone, y=ratio, fill=chrone)) +
scale_fill_manual(values = c("red","red","grey")) +
scale_y_continuous(limits = c(-6,6)) +
geom_boxplot(notch = TRUE)
ggplot(map.data, aes(x=chrone, y=ratio, fill=chrone)) +
scale_fill_manual(values = c("grey","red","red")) +
scale_y_continuous(limits = c(-6,6)) +
geom_boxplot(notch = TRUE)+
theme(legend.position="none") +
labs(x='Chromosome', y='Log2 ratio of XY/XX gene expression') +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
#gene expression ratio Log2(XY/XX)
pdf("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/log2ratio_XYXXsexreversal_allauto.pdf", width=8, height=8)
ggplot(map.data, aes(x=chrone, y=ratio, fill=chrone)) +
scale_fill_manual(values = c("grey","red","red")) +
scale_y_continuous(limits = c(-6,6)) +
geom_boxplot(notch = TRUE)+
theme(legend.position="none") +
labs(x='Chromosome', y='Log2 ratio of XY/XX gene expression') +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
#stats
##
wilcox.test(map.data$ratio[map.data$chr=='Chr01'],map.data$ratio[map.data$chr=='Chr02'],exact = FALSE)
##W = 291820, p-value = 0.9756
wilcox.test(map.data$ratio[map.data$chr=='Chr01'],map.data$ratio[map.data$chr!='Chr01'],exact = FALSE)
t <- rbind(map.data$ratio[map.data$chr=='Chr01'],map.data$ratio[map.data$chr=='Chr02'])
##W = 291820, p-value = 0.9756
withoutchr01 <- subset(map.data,map.data$ratio[map.data$chr!='Chr01'])
##W = 291820, p-value = 0.9756
withoutchr01 <- subset(map.data, map.data$chr!='Chr01'])
##W = 291820, p-value = 0.9756
withoutchr01 <- subset(map.data, map.data$chr!='Chr01')
withoutchr0102 <- subset(withoutchr01, withoutchr01$chr!='Chr02')
withoutchr0102
wilcox.test(map.data$ratio[map.data$chr=='Chr01'],withoutchr01$ratio[withoutchr01$chr!='Chr02'],exact = FALSE)
##W = 1525200, p-value = 0.513
wilcox.test(map.data$ratio[map.data$chr=='Chr02'],withoutchr01$ratio[withoutchr01$chr!='Chr02'],exact = FALSE)
install.packages("VennDiagram")
library("VennDiagram")
library(gridExtra)
library(grid)
library(ggplot2)
library(lattice)
#for the shared female-biased genes across five stages.
setwd <-'/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/'
datapath <- '/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/'
results <- '/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/'
#for tissues from developmental stages, shared female-biased genes
all_sbias <- read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/venn_diag/de_0.05_1_Am_alltissues.txt", header = TRUE)
str(all_sbias)
#################
#######adult shared sex-biased genes
#################
adult_sbias <- subset(all_sbias,all_sbias$tissue!='larva')
str(adult_sbias)
adult_gonad <- adult_sbias$gid[adult_sbias$stage=='Gonad']
adult_brain <- adult_sbias$gid[adult_sbias$stage=='Brain']
adult_liver <- adult_sbias$gid[adult_sbias$stage=='Liver']
################
#######G46 and gonad shared sex-biased genes
################
adult_sbias <- subset(all_sbias,all_sbias$tissue!='larva')
adult_sgonad <- adult_sbias$gid[adult_sbias$stage=='Gonad']
str(adult_sgonad)
larva_sbias <- subset(all_sbias,all_sbias$tissue!='adult')
sbias_g46 <- larva_sbias$gid[larva_sbias$stage=='G46']
adult_sgonad <- adult_sbias$gid[adult_sbias$stage=='Gonad']
str(adult_sgonad)
fbias_g46 <- larva_fbias$gid[larva_fbias$stage=='G46']
sbias_g46 <- larva_sbias$gid[larva_sbias$stage=='G46']
head(sbias_g46)
#test whether the overlap is greater than by chance.
share_gonadG46 <- list(as.character(adult_sgonad), as.character(sbias_g46))
list(share_gonadG46)
str(share_gonadG46)
total3 <- 13591
res=supertest(share_gonadG46, n=total3)
plot(res, Layout="landscape", degree=2:4, sort.by="size")
install.packages("VennDiagram")
library("VennDiagram")
library(gridExtra)
library(grid)
library(ggplot2)
library(lattice)
install.packages("VennDiagram")
res=supertest(share_gonadG46, n=total3)
plot(res, Layout="landscape", degree=2:4, sort.by="size")
?supertest
??supertest
#test whether the overlap is greater than by chance.
share_gonadG46 <- list(as.character(adult_sgonad), as.character(sbias_g46))
list(share_gonadG46)
str(share_gonadG46)
total3 <- 13591
res=supertest(share_gonadG46, n=total3)
res=supertest(share_gonadG46, n=total3)
res=supertest(share_gonadG46, n=total3)
SuperExactTest::cpdiff()
supertest
npm install supertest --save-dev
