facet_grid(~stage) +
scale_x_discrete(labels=c("XX", "XY'", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1.5)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
#boxplot
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~order(stage)) +
scale_x_discrete(labels=c("XX", "XY'", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1.5)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
#boxplot
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("XX", "XY'", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1.5)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
#boxplot
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("XX", "XY'", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1.5)) +
theme(axis.title.x = element_text(size=14,colour = "black"),axis.title.y = element_text(size=14,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=11),axis.text.y = element_text(colour="black",size=11))
#boxplot
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1.5)) +
theme(axis.title.x = element_text(size=14,colour = "black"),axis.title.y = element_text(size=14,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=11),axis.text.y = element_text(colour="black",size=11))
str(dn_ds_all)
dn_ds_all <- data.frame(with(dn_ds_all,dn_ds_all[order(stage,sb,dnds),]))
head(dn_ds_all)
dn_ds_all <- data.frame(with(dn_ds_all,dn_ds_all[order(stage,sb,dnds),]))
head(dn_ds_all)
dn_ds_all<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/amm_dnds_all_mod.txt", header = T)
head(dn_ds_all)
dn_ds_all <- data.frame(with(dn_ds_all,dn_ds_all[order(stage),]))
head(dn_ds_all)
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1.5)) +
theme(axis.title.x = element_text(size=14,colour = "black"),axis.title.y = element_text(size=14,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=11),axis.text.y = element_text(colour="black",size=11))
#load datasets
sb <- read.table('/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/amm_sexbias.txt', header = TRUE)
str(sb)
head(sb)
sb <- data.frame(with(sb,sb[order(Gosner_stage,Fold_change,Sex_bias),]))
head(sb)
dn_ds_all <- data.frame(with(dn_ds_all,dn_ds_all[order(stage,sb,ID,dnds),]))
head(dn_ds_all)
amm_dnds_all <- arrangeGrob(gTree(childreny),ncol = 1 )
pdf(filename="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dnds_all.pdf")
?pdf
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dnds_all.pdf")
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1.5)) +
theme(axis.title.x = element_text(size=14,colour = "black"),axis.title.y = element_text(size=14,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=11),axis.text.y = element_text(colour="black",size=11))
dev.off()
ggplot(dn_ds_all, aes(x=sb, y=dn,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("XX", "XY'", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dn_all.pdf")
ggplot(dn_ds_all, aes(x=sb, y=dn,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("XX", "XY'", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dn_all.pdf")
ggplot(dn_ds_all, aes(x=sb, y=dn,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_ds_all.pdf")
ggplot(dn_ds_all, aes(x=sb, y=ds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2.5)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_ds_all.pdf")
ggplot(dn_ds_all, aes(x=sb, y=ds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2.5)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
ggplot(dn_ds_all, aes(x=sb, y=ds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2.5)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
ggplot(dn_ds_all, aes(x=reorder(stage,dnds), y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1.5)) +
theme(axis.title.x = element_text(size=14,colour = "black"),axis.title.y = element_text(size=14,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=11),axis.text.y = element_text(colour="black",size=11))
ggplot(dn_ds_all, aes(x=dnds, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1.5)) +
theme(axis.title.x = element_text(size=14,colour = "black"),axis.title.y = element_text(size=14,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=11),axis.text.y = element_text(colour="black",size=11))
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1.5)) +
theme(axis.title.x = element_text(size=14,colour = "black"),axis.title.y = element_text(size=14,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=11),axis.text.y = element_text(colour="black",size=11))
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1)) +
theme(axis.title.x = element_text(size=14,colour = "black"),axis.title.y = element_text(size=14,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=11),axis.text.y = element_text(colour="black",size=11))
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,2)) +
theme(axis.title.x = element_text(size=14,colour = "black"),axis.title.y = element_text(size=14,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=11),axis.text.y = element_text(colour="black",size=11))
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1)) +
theme(axis.title.x = element_text(size=14,colour = "black"),axis.title.y = element_text(size=14,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=11),axis.text.y = element_text(colour="black",size=11))
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dnds_all.pdf")
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1)) +
theme(axis.title.x = element_text(size=14,colour = "black"),axis.title.y = element_text(size=14,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=11),axis.text.y = element_text(colour="black",size=11))
dev.off()
ggplot(dn_ds_all, aes(x=sb, y=dn,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
ggplot(dn_ds_all, aes(x=sb, y=dn,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN", limits = c(0,1.25)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dn_all.pdf")
ggplot(dn_ds_all, aes(x=sb, y=dn,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN", limits = c(0,1.25)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
ggplot(dn_ds_all, aes(x=sb, y=ds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2.5)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
ggplot(dn_ds_all, aes(x=sb, y=ds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_ds_all.pdf")
ggplot(dn_ds_all, aes(x=sb, y=ds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dS", limits = c(0,2)) +
theme(axis.title.x = element_text(size=16,colour = "black"),axis.title.y = element_text(size=16,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=12),axis.text.y = element_text(colour="black",size=12))
dev.off()
sex_auto<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/sexauto_dnds_all.txt", header = T)
str(sex_auto)
sex_auto<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/sexauto_dnds_all.txt", header = T)
sex_auto<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/sexauto_dnds_all.txt", header = T)
str(sex_auto)
#dn/ds plot for Faster-X
ggplot(sex_auto, aes(x=reorder(chrid,dNdS), y=dNdS, fill=type)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
#dn/ds plot for Faster-X
ggplot(sex_auto, aes(x=reorder(chrid), y=dNdS, fill=type)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
#dn/ds plot for Faster-X
ggplot(sex_auto, aes(x=reorder(chrid,dNdS), y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
#dn/ds plot for Faster-X
ggplot(sex_auto, aes(x=reorder(chrid), y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
#dn/ds plot for Faster-X
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
sex_auto<-read.table("/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/input/sexauto_dnds_all.txt", header = T)
str(sex_auto)
#dn/ds plot for Faster-X
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
#dn/ds plot for Faster-X
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
head(sex_auto)
#dn/ds plot for Faster-X
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
#scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
#dn/ds plot for Faster-X
ggplot(sex_auto, aes(x=reorder(chrid,dNdS), y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("firebrick2","grey")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
#scale_x_discrete(labels = c("Sex chromosome", "Autosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
#dn/ds plot for Faster-X
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
#scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
#dn/ds plot for Faster-X
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
#dn/ds plot for Faster-X
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX.pdf")
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
str(sex_auto)
wilcox.test(sex_auto$dNdS[sex_auto$chrid=='sexchr'], sex_auto$dNdS[sex_auto$chrid=='Auto'])
mean(sex_auto$dNdS[sex_auto$chrid=='sexchr'])
mean(sex_auto$dNdS[sex_auto$chrid=='Auto'])
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
scale_y_continuous(limits = c(0,0.5)) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
scale_y_continuous(limits = c(0,0.4)) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
scale_y_continuous(limits = c(0,0.3)) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX0.3.pdf")
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
scale_y_continuous(limits = c(0,0.3)) +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
#G46
qqnorm(log(dn_ds$dNdS)) #unlikely normal distribution
ggplot(sex_auto, aes(x=chr, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
#scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
ggplot(sex_auto, aes(x=chr, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Chr01","Chr02")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
###if separate to compare Chr01, Chr02 and autosome
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX.pdf")
ggplot(sex_auto, aes(x=chr, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Chr01","Chr02")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
###if separate to compare Chr01, Chr02 and autosome
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX_chr0102.pdf")
ggplot(sex_auto, aes(x=chr, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Chr01","Chr02")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
wilcox.test(sex_auto$dNdS[sex_auto$chr=='Chr01'], sex_auto$dNdS[sex_auto$chr=='Auto'])
mean(sex_auto$dNdS[sex_auto$chrid=='Chr01'])
mean(sex_auto$dNdS[sex_auto$chrid=='Chr02'])
mean(sex_auto$dNdS[sex_auto$chr=='Chr01'])
mean(sex_auto$dNdS[sex_auto$chr=='Chr02'])
mean(sex_auto$dNdS[sex_auto$chr=='Auto'])
wilcox.test(sex_auto$dNdS[sex_auto$chr=='Chr02'], sex_auto$dNdS[sex_auto$chr=='Auto'])
wilcox.test(sex_auto$dNdS[sex_auto$chr=='Chr01'], sex_auto$dNdS[sex_auto$chr=='Auto'])
#data:  sex_auto$dNdS[sex_auto$chr == "Chr02"] and sex_auto$dNdS[sex_auto$chr == "Auto"]
#W = 2478900, p-value = 0.05034
#alternative hypothesis: true location shift is not equal to 0
wilcox.test(sex_auto$dNdS[sex_auto$chr=='Chr01'], sex_auto$dNdS[sex_auto$chr=='Chr02'])
#dn/ds plot for Faster-X
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_fasterX.pdf")
ggplot(sex_auto, aes(x=chrid, y=dNdS, fill=chrid)) +
scale_fill_manual(values = c("grey","firebrick2")) +
theme(legend.position="none") +
geom_boxplot() +
labs(x='Chromosome', y='dn/ds') +
scale_x_discrete(labels = c("Autosome","Sex chromosome")) +
theme(axis.text=element_text(size=12, color="black"),text = element_text(size=15,color="black"))
dev.off()
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dnds_all.pdf")
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1)) +
theme(axis.title.x = element_text(size=14,colour = "black"),axis.title.y = element_text(size=14,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=10),axis.text.y = element_text(colour="black",size=10))
dev.off()
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1)) +
theme(axis.title.x = element_text(size=12,colour = "black"),axis.title.y = element_text(size=12,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=10),axis.text.y = element_text(colour="black",size=10))
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dnds_all.pdf")
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Unbias"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1)) +
theme(axis.title.x = element_text(size=12,colour = "black"),axis.title.y = element_text(size=12,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=10),axis.text.y = element_text(colour="black",size=10))
dev.off()
pdf(file="/Users/Wen-Juan/my_postdoc/useful_scripts/Rana_Transcriptome/output/figures/amm_dnds_all.pdf")
ggplot(dn_ds_all, aes(x=sb, y=dnds,fill=(sb))) +
geom_boxplot(notch = FALSE) +
scale_fill_manual(values = c("firebrick2","dodgerblue2","grey")) +
theme(legend.position="none") +
facet_grid(~stage) +
scale_x_discrete(labels=c("F", "M", "Un"),name="Sex bias") +
scale_y_continuous(name = "dN/dS", limits = c(0,1)) +
theme(axis.title.x = element_text(size=12,colour = "black"),axis.title.y = element_text(size=12,colour = "black")) +
theme(axis.text.x = element_text(colour="black",size=10),axis.text.y = element_text(colour="black",size=10))
dev.off()
